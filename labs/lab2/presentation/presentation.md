---
## Front matter
lang: ru-RU
title: Лабораторная работа №2
subtitle: Кибербезопасность предприятия. Сценарий №5
author:
  - Боровиков Даниил
  - Хрусталев Влад 
  - Гисматуллин Артём
  - Чесноков Артёмий
  - Коннова Татьяна
  - Нефедова Наталья
  - Уткина Алина
  - Бансимба Клодели

institute:
  - Российский университет дружбы народов, Москва, Россия

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
 
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
---

## Задачи

ЗАЩИТА НАУЧНО-ТЕХНИЧЕСКОЙ ИНФОРМАЦИИ ПРЕДПРИЯТИЯ

Внешний нарушитель умеет использовать инструментарий для
проведения компьютерных атак, знает техники постэксплуатации.

Средство обнаружения вторжений – программно-аппаратный комплекс
для обнаружения вторжений в информационные системы ViPNet IDS NS.

Автоматическое выявление инцидентов на основе интеллектуального
анализа событий информационной безопасности – программно-аппаратный
комплекс ViPNet TIAS.

ViPNet EPP применяется для защиты отдельных компонентов
информационной инфраструктуры организаций – персональных компьютеров
пользователей и корпоративных серверов.

## Действия нарушителя 

1. Внутренний нарушитель подбирает пароль на файловый сервер и
меняет существующий на сервере файл другим файлом с backdoor (дефектом
алгоритма).

2. Пользователь Dev-1 загружает и запускает файл с backdoor.

3. Внутренний нарушитель получает контроль над компьютером
пользователя Dev-1 и загружает скрипт для похищения учетных данных из
браузера. Запускает данный скрипт и получает логин и пароль к Redmine.

## Действия нарушителя 

4. Внутренний нарушитель проводит атаку stored XSS для включения
на Redmine сервере REST API. Вредоносный код записывается на Wikiстраницу проекта Dev1. Получив доступ к консоли администратора,
внутренний нарушитель создает нового пользователя Redmine с правами
администратора.

5. Внутренний нарушитель ожидает, когда администратор
просмотрит страницу с внедренным вредоносным кодом.

6. Внутренний нарушитель проводит Blind SQL-инъекцию, получает
доступ к данным конфиденциального проекта.

# Процесс выполнения лабораторной работы

## Последствие Dev backdoor

![Файл svchosting.exe в папке Downloads](image/01.PNG){ #fig:001 width=100% height=100% }

## Последствие Dev backdoor

![Задание "Evil task" в планировщике задач](image/02.PNG){ #fig:002 width=100% height=100% }

## Последствие Dev backdoor

![Настройки задания с путем к вредоносному файлу](image/03.PNG){ #fig:003 width=100% height=100% }

## XSS-код 

![Вредоносный XSS-код на Wiki-странице](image/04.PNG){ #fig:004 width=100% height=100% }

## redcloth3.rb

![Исходный код файла redcloth3.rb](image/05.PNG){ #fig:005 width=100% height=100% }

## redcloth3.rb

![Исправленная версия файла redcloth3.rb](image/06.PNG){ #fig:006 width=100% height=100% }

## Перезапуск службы

![Перезапуск службы nginx](image/07.PNG){ #fig:007 width=100% height=100% }

## Список пользователей

![Список пользователей Redmine с пользователем "hacker"](image/08.PNG){ #fig:008 width=100% height=100% }

## Удаление пользователя

![Подтверждение удаления пользователя](image/09.PNG){ #fig:009 width=100% height=100% }

## Изучение логов

![Логи Redmine с SQL-инъекцией](image/010.PNG){ #fig:010 width=100% height=100% }

## query.rb

![Исправление в файле query.rb](image/011.PNG){ #fig:011 width=100% height=100% }

## Завершение работы

![Главная страница](image/012.PNG){ #fig:012 width=100% height=100% }

## Завершение работы

![Карточки инцидентов и последствий](image/013.PNG){ #fig:013 width=100% height=100% }

## Выводы

В рамках учебно-практического занятия на базе программного комплекса обучения методам обнаружения, анализа и устранения последствий компьютерных атак «Ampire» мы выполнили сценарий №5 «Защита научно-технической информации предприятия». Внутренний нарушитель, используя слабые пароли и уязвимости в веб-приложении Redmine, осуществил комплексную атаку с целью получения доступа к конфиденциальной информации. 
Нарушитель применил техники внедрения backdoor, эксплуатации XSS-уязвимости и слепой SQL-инъекции для создания привилегированного пользователя и несанкционированного доступа к данным. Уровень сложности сценария — 8 (из 10). Мы успешно выявили уязвимости, проанализировали последствия атаки, устранили их и отработали методы детектирования с использованием инструментов ViPNet IDS NS, ViPNet TIAS и Security Onion, 
а также освоили методики исправления исходного кода приложений для устранения уязвимостей.
